<!doctype html><html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>To-Do App (MS)</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head><body class="p-4">
<h1 class="mb-3">To-Do App – Microservicios</h1>

<div class="mb-3 d-flex gap-2">
  <input id="title" class="form-control" placeholder="Nueva tarea...">
  <button class="btn btn-primary" onclick="addTask()">Agregar</button>
</div>

<div class="mb-3">
  <button class="btn btn-outline-secondary" onclick="loadTasks()">Actualizar</button>
  <a class="btn btn-outline-info" href="/me/tasks" target="_blank">/me/tasks (retry+CB)</a>
</div>

<ul id="list" class="list-group"></ul>

<script>
const LB = '';

async function loadTasks(){
  const res = await fetch(`${LB}/tasks`);
  const data = await res.json();
  const ul = document.getElementById('list');
  ul.innerHTML = '';
  data.forEach(t=>{
    const li = document.createElement('li');
    li.className = 'list-group-item d-flex justify-content-between align-items-center';
    li.innerHTML = `
      <span>${t.done ? '✅' : '⬜'} ${t.title}</span>
      <div class="btn-group">
        <button class="btn btn-sm btn-success" onclick="markDone(${t.id}, ${!t.done})">${t.done?'Desmarcar':'Marcar'}</button>
      </div>`;
    ul.appendChild(li);
  });
}
async function addTask(){
  const title = document.getElementById('title').value.trim();
  if(!title) return;
  await fetch(`${LB}/tasks`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({title})});
  document.getElementById('title').value='';
  loadTasks();
}
async function markDone(id, done){
  await fetch(`${LB}/tasks/${id}/done`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({done})});
  loadTasks();
}
loadTasks();
</script>
</body></html>
